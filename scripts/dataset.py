import os
import csv

# Array defining the labels for each image
rearrange = [
    'ई','ऐ','ओ', 'औ','अ', 'आ','इ','उ', 'ऊ', 'ए', 'अं', 'अः',
    'कि', 'की', 'के', 'कै','को', 'कौ', 'क', 'का','कु', 'कू','कं', 'कः',
    'खि', 'खी', 'खे', 'खै','खो', 'खौ', 'ख', 'खा','खु', 'खू','खं', 'खः',
    'गि', 'गी', 'गे', 'गै','गो', 'गौ', 'ग', 'गा','गु', 'गू','गं', 'गः',
    'घि', 'घी', 'घे', 'घै','घो', 'घौ', 'घ', 'घा','घु', 'घू','घं', 'घः',
    'ङि', 'ङी', 'ङे', 'ङै','ङो', 'ङौ', 'ङ', 'ङा','ङु', 'ङू','ङं', 'ङः',
    'चि', 'ची', 'चे', 'चै','चो', 'चौ', 'च', 'चा','चु', 'चू','चं', 'चः',
    'छि', 'छी', 'छे', 'छै','छो', 'छौ', 'छ', 'छा','छु', 'छू','छं', 'छः',
    'जि', 'जी', 'जे', 'जै','जो', 'जौ', 'ज', 'जा','जु', 'जू','जं', 'जः',
    'झि', 'झी', 'झे', 'झै','झो', 'झौ', 'झ', 'झा','झु', 'झू','झं', 'झः',
    'ञि', 'ञी', 'ञे', 'ञै','ञो', 'ञौ', 'ञ', 'ञा','ञु', 'ञू','ञं', 'ञः',
    'टि', 'टी', 'टे', 'टै','टो', 'टौ', 'ट', 'टा','टु', 'टू','टं', 'टः',
    'ठि', 'ठी', 'ठे', 'ठै','ठो', 'ठौ', 'ठ', 'ठा','ठु', 'ठू','ठं', 'ठः',
    'डि', 'डी', 'डे', 'डै','डो', 'डौ', 'ड', 'डा','डु', 'डू','डं', 'डः',
    'ढि', 'ढी', 'ढे', 'ढै','ढो', 'ढौ', 'ढ', 'ढा','ढु', 'ढू','ढं', 'ढः',
    'णि', 'णी', 'णे', 'णै','णो', 'णौ', 'ण', 'णा','णु', 'णू','णं', 'णः',
    'ति', 'ती', 'ते', 'तै','तो', 'तौ', 'त', 'ता','तु', 'तू','तं', 'तः',
    'थि', 'थी', 'थे', 'थै','थो', 'थौ', 'थ', 'था','थु', 'थू','थं', 'थः',
    'दि', 'दी', 'दे', 'दै','दो', 'दौ', 'द', 'दा','दु', 'दू','दं', 'दः',
    'धि', 'धी', 'धे', 'धै','धो', 'धौ', 'ध', 'धा','धु', 'धू','धं', 'धः',
    'नि', 'नी', 'ने', 'नै','नो', 'नौ', 'न', 'ना','नु', 'नू','नं', 'नः',
    'पि', 'पी', 'पे', 'पै','पो', 'पौ', 'प', 'पा','पु', 'पू','पं', 'पः',
    'फि', 'फी', 'फे', 'फै','फो', 'फौ', 'फ', 'फा','फु', 'फू','फं', 'फः',
    'बि', 'बी', 'बे', 'बै','बो', 'बौ', 'ब', 'बा','बु', 'बू','बं', 'बः',
    'भि', 'भी', 'भे', 'भै','भो', 'भौ', 'भ', 'भा','भु', 'भू','भं', 'भः',
    'मि', 'मी', 'मे', 'मै','मो', 'मौ', 'म', 'मा','मु', 'मू','मं', 'मः',
    'यि', 'यी', 'ये', 'यै','यो', 'यौ', 'य', 'या','यु', 'यू','यं', 'यः',
    'रि', 'री', 'रे', 'रै','रो', 'रौ', 'र', 'रा','रु', 'रू','रं', 'रः',
    'लि', 'ली', 'ले', 'लै','लो', 'लौ', 'ल', 'ला','लु', 'लू','लं', 'लः',
    'वि', 'वी', 'वे', 'वै','वो', 'वौ', 'व', 'वा','वु', 'वू','वं', 'वः',
    'शि', 'शी', 'शे', 'शै','शो', 'शौ', 'श', 'शा','शु', 'शू','शं', 'शः',
    'षि', 'षी', 'षे', 'षै','षो', 'षौ', 'ष', 'षा','षु', 'षू','षं', 'षः',
    'सि', 'सी', 'से', 'सै','सो', 'सौ', 'स', 'सा','सु', 'सू','सं', 'सः',
    'हि', 'ही', 'हे', 'है','हो', 'हौ', 'ह', 'हा','हु', 'हू','हं', 'हः',
    'ळि', 'ळी', 'ळे', 'ळै','ळो', 'ळौ', 'ळ', 'ळा','ळु', 'ळू','ळं', 'ळः',
    'क्षि', 'क्षी', 'क्षे', 'क्षै','क्षो', 'क्षौ', 'क्ष', 'क्षा','क्षु', 'क्षू','क्षं', 'क्षः',
    'ज्ञि', 'ज्ञी', 'ज्ञे', 'ज्ञै','ज्ञो', 'ज्ञौ', 'ज्ञ', 'ज्ञा','ज्ञु', 'ज्ञू','ज्ञं', 'ज्ञः'
]
print(len(rearrange))  # Ensure there are 444 labels

def create_csv(root, sets, sub_folders, folders, rearrange, csv_file):
    """
    Creates a CSV file with image paths and their corresponding labels.

    Parameters:
    root (str): Root directory containing the image sets.
    sets (list): List of set folders.
    sub_folders (list): List of sub-folders within each set.
    folders (list): List of folders within each sub-folder.
    rearrange (list): List of labels for the images.
    csv_file (str): Name of the CSV file to create.

    Returns:
    None
    """
    try:
        with open(csv_file, mode='w', encoding='utf-8', newline='') as file:
            writer = csv.writer(file)
            writer.writerow(['image_path', 'label'])
            
            # Iterate through each set, sub-folder, and folder to write the image paths and labels
            for set_num in sets:
                set_folder = f'set-{set_num}'
                for sub_folder in sub_folders:
                    for folder in folders:
                        for i in range(1, 445):
                            img_path = os.path.join(root, set_folder, sub_folder, folder, f'word_{i}.png')
                            label = rearrange[i - 1]
                            writer.writerow([img_path, label])
        
        print('CSV file created successfully')

    except Exception as e:
        print(f"Error: {e}")

if __name__ == "__main__":
    root = 'characters-48x48'
    sets = [1, 2, 3, 4]
    sub_folders = ['classic', 'down', 'left', 'right', 'up']
    folders = ['bold', 'boldNitalic', 'italic', 'normal']
    csv_file = 'data.csv'

    create_csv(root, sets, sub_folders, folders, rearrange, csv_file)
